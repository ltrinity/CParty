\doxysection{VM\+\_\+final.\+cpp}
\hypertarget{_v_m__final_8cpp_source}{}\label{_v_m__final_8cpp_source}\index{C:/Users/luket/Desktop/testing\_CParty/CParty/VM\_final.cpp@{C:/Users/luket/Desktop/testing\_CParty/CParty/VM\_final.cpp}}
\mbox{\hyperlink{_v_m__final_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{_v_m__final_8h}{VM\_final.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00002}00002\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{externs_8h}{externs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00003}00003\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{h__externs_8h}{h\_externs.h}}"{}}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00004}00004\ \textcolor{preprocessor}{\#include\ "{}math.h"{}}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00006}\mbox{\hyperlink{class_v_m__final_abe7c9ed0d4cac811bd2fa4b1707f7a7b}{00006}}\ \mbox{\hyperlink{class_v_m__final_abe7c9ed0d4cac811bd2fa4b1707f7a7b}{VM\_final::VM\_final}}(\textcolor{keywordtype}{int}\ *seq,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{len}})}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00007}00007\ \{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00008}00008\ \ \ \ \ \mbox{\hyperlink{class_v_m__final_ac2e51649818a4f49a58dea7c167dc021}{length}}\ =\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{len}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00009}00009\ \ \ \ \ \mbox{\hyperlink{class_v_m__final_a25c1aaa232ddde4a1e5a4b838ac7a4f7}{sequence}}\ =\ seq;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00010}00010\ \ \ \ \ this-\/>\mbox{\hyperlink{class_v_m__final_a194e9caa8420fa196e18179389238853}{v}}\ =\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{NULL}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00011}00011\ \ \ \ \ this-\/>\mbox{\hyperlink{class_v_m__final_ab44b4b037c46d438421fdf68f7f06973}{wmb}}\ =\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{NULL}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00013}00013\ \ \ \ \ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{int}[\mbox{\hyperlink{class_v_m__final_ac2e51649818a4f49a58dea7c167dc021}{length}}];\ \ \ \ \textcolor{comment}{//\ an\ array\ with\ indexes,\ such\ that\ we\ don't\ work\ with\ a\ 2D\ array,\ but\ with\ a\ 1D\ array\ of\ length\ (n*(n+1))/2}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00014}00014\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{total\_length}}\ =\ (\mbox{\hyperlink{class_v_m__final_ac2e51649818a4f49a58dea7c167dc021}{length}}\ *(\mbox{\hyperlink{class_v_m__final_ac2e51649818a4f49a58dea7c167dc021}{length}}+1))/2;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00015}00015\ \ \ \ \ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[0]\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00016}00016\ \ \ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00017}00017\ \ \ \ \ \textcolor{keywordflow}{for}\ (i=1;\ i\ <\ \mbox{\hyperlink{class_v_m__final_ac2e51649818a4f49a58dea7c167dc021}{length}};\ i++)}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00018}00018\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i]\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i-\/1]+\mbox{\hyperlink{class_v_m__final_ac2e51649818a4f49a58dea7c167dc021}{length}}-\/i+1;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00023}00023\ \ \ \ \ \mbox{\hyperlink{class_v_m__final_a0c8581d26850e7e1d79134d44bfa19a4}{WM}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ [\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{total\_length}}];}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00024}00024\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_v_m__final_a0c8581d26850e7e1d79134d44bfa19a4}{WM}}\ ==\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{NULL}})\ \mbox{\hyperlink{common_8cpp_a92de552f74ae0cdbb3b86774d44b8b85}{giveup}}\ (\textcolor{stringliteral}{"{}Cannot\ allocate\ memory"{}},\ \textcolor{stringliteral}{"{}VM\_final"{}});}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00025}00025\ \ \ \ \ \textcolor{keywordflow}{for}\ (i=0;\ i\ <\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{total\_length}};\ i++)\ \mbox{\hyperlink{class_v_m__final_a0c8581d26850e7e1d79134d44bfa19a4}{WM}}[i]\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00026}00026\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00027}00027\ \ \ \ \ \mbox{\hyperlink{class_v_m__final_a5d890ab36a54d7ca2f600abb94b42f84}{WM1}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ [\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{total\_length}}];}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00028}00028\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_v_m__final_a5d890ab36a54d7ca2f600abb94b42f84}{WM1}}\ ==\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{NULL}})\ \mbox{\hyperlink{common_8cpp_a92de552f74ae0cdbb3b86774d44b8b85}{giveup}}\ (\textcolor{stringliteral}{"{}Cannot\ allocate\ memory"{}},\ \textcolor{stringliteral}{"{}VM\_final"{}});}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00029}00029\ \ \ \ \ \textcolor{keywordflow}{for}\ (i=0;\ i\ <\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{total\_length}};\ i++)\ \mbox{\hyperlink{class_v_m__final_a5d890ab36a54d7ca2f600abb94b42f84}{WM1}}[i]\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00031}00031\ \ \ \ \ \mbox{\hyperlink{class_v_m__final_a1582016485ac99a12f9adc4f6e99d665}{WMP}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ [\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{total\_length}}];}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00032}00032\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_v_m__final_a1582016485ac99a12f9adc4f6e99d665}{WMP}}\ ==\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{NULL}})\ \mbox{\hyperlink{common_8cpp_a92de552f74ae0cdbb3b86774d44b8b85}{giveup}}\ (\textcolor{stringliteral}{"{}Cannot\ allocate\ memory"{}},\ \textcolor{stringliteral}{"{}VM\_final"{}});}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00033}00033\ \ \ \ \ \textcolor{keywordflow}{for}\ (i=0;\ i\ <\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{total\_length}};\ i++)\ \mbox{\hyperlink{class_v_m__final_a1582016485ac99a12f9adc4f6e99d665}{WMP}}[i]\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00035}00035\ \ \ \ \ \mbox{\hyperlink{class_v_m__final_af61903e978064ce7a10d483598e339f5}{VM}}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ [\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{total\_length}}];}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00036}00036\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_v_m__final_af61903e978064ce7a10d483598e339f5}{VM}}\ ==\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{NULL}})\ \mbox{\hyperlink{common_8cpp_a92de552f74ae0cdbb3b86774d44b8b85}{giveup}}\ (\textcolor{stringliteral}{"{}Cannot\ allocate\ memory"{}},\ \textcolor{stringliteral}{"{}VM\_final"{}});}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00037}00037\ \ \ \ \ \textcolor{keywordflow}{for}\ (i=0;\ i\ <\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{total\_length}};\ i++)\ \mbox{\hyperlink{class_v_m__final_af61903e978064ce7a10d483598e339f5}{VM}}[i]\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00039}00039\ \textcolor{comment}{//\ \ \ \ printf("{}an\ object\ of\ VM\_final\ was\ successfully\ created!\ \(\backslash\)n"{});}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00040}00040\ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00042}\mbox{\hyperlink{class_v_m__final_a674395a7ecbf4df95f94ef122d04fd3d}{00042}}\ \mbox{\hyperlink{class_v_m__final_a674395a7ecbf4df95f94ef122d04fd3d}{VM\_final::\string~VM\_final}}()}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00043}00043\ \{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00044}00044\ \ \ \ \ \textcolor{keyword}{delete}\ []\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00045}00045\ \ \ \ \ \textcolor{keyword}{delete}\ []\ \mbox{\hyperlink{class_v_m__final_a0c8581d26850e7e1d79134d44bfa19a4}{WM}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00046}00046\ \ \ \ \ \textcolor{keyword}{delete}\ []\ \mbox{\hyperlink{class_v_m__final_a5d890ab36a54d7ca2f600abb94b42f84}{WM1}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00047}00047\ \ \ \ \ \textcolor{keyword}{delete}\ []\ \mbox{\hyperlink{class_v_m__final_a1582016485ac99a12f9adc4f6e99d665}{WMP}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00048}00048\ \ \ \ \ \textcolor{keyword}{delete}\ []\ \mbox{\hyperlink{class_v_m__final_af61903e978064ce7a10d483598e339f5}{VM}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00049}00049\ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00050}00050\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00051}\mbox{\hyperlink{class_v_m__final_a93be16c2f2e6d3b7a24db48dd48e76b7}{00051}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_v_m__final_a93be16c2f2e6d3b7a24db48dd48e76b7}{VM\_final::compute\_energy}}(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j,\ \mbox{\hyperlink{structstr__features}{str\_features}}\ *fres)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00054}00054\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00055}00055\ \ \ \ \ \textcolor{comment}{//\ Hosna\ June\ 26,\ 2007}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00056}00056\ \ \ \ \ \textcolor{comment}{//\ I\ have\ to\ figure\ out\ how\ to\ calculate\ the\ energy\ here}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00058}00058\ \ \ \ \ \textcolor{comment}{//\ here\ comes\ the\ copied\ part\ from\ simfold\ with\ all\ dangling\ energies}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00059}00059\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{min}}\ =\ \mbox{\hyperlink{constants_8h_a12c2040f25d8e3a7b9e1c2024c618cb6}{INF}},\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{tmp}},\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00060}00060\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{iplus1k}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00061}00061\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{kplus1jminus1}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00062}00062\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{iplus2k}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00063}00063\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{kplus1jminus2}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00064}00064\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00065}00065\ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}=i+1;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00066}00066\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{kjminus1}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}]\ +\ j-\/1-\/\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00068}00068\ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_vm}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00069}00069\ \ \ \ \ \textcolor{comment}{//d2\_energy\_vm\ +=\ WMP[kjminus1]\ *\ exp(misc.multi\_helix\_penalty\ +\ misc.multi\_offset\ +\ AU\_penalty\ (sequence[i],\ sequence[j])*oneoverRT);}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00072}00072\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}\ =\ i+2;\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}\ <=\ j-\/1;\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}++)}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00073}00073\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00074}00074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{iplus1k}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i+1]\ +\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}\ -\/i-\/1;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00075}00075\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{kplus1jminus1}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}+1]\ +\ j-\/1\ -\/\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}-\/1;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00076}00076\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{iplus2k}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i+2]\ +\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}\ -\/i-\/2;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00077}00077\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{kplus1jminus2}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}+1]\ +\ j-\/2\ -\/\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}-\/1;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00080}00080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_vm}}\ +=\ (\mbox{\hyperlink{class_v_m__final_a0c8581d26850e7e1d79134d44bfa19a4}{WM}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{iplus1k}}]\ *\ \mbox{\hyperlink{class_v_m__final_a5d890ab36a54d7ca2f600abb94b42f84}{WM1}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{kplus1jminus1}}]\ *\ \mbox{\hyperlink{common_8cpp_a9fe853f65a0f16e66d7a28c7b9fa551c}{bw\_int}}(\mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_a3406bfe1dbd73a8cd9fede03816a1fa2}{multi\_helix\_penalty}}\ +\ \mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_ab6141294a0aac68e8a99e4b29cbdca86}{multi\_offset}}\ +\ \mbox{\hyperlink{common_8h_ab8cd17eff60c63faedab23965fdf886d}{AU\_penalty}}\ (\mbox{\hyperlink{class_v_m__final_a25c1aaa232ddde4a1e5a4b838ac7a4f7}{sequence}}[i],\ \mbox{\hyperlink{class_v_m__final_a25c1aaa232ddde4a1e5a4b838ac7a4f7}{sequence}}[j])));;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00082}00082\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_vm}}\ +=\ \mbox{\hyperlink{class_v_m__final_a0c8581d26850e7e1d79134d44bfa19a4}{WM}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{iplus1k}}]\ *\ \mbox{\hyperlink{class_v_m__final_a1582016485ac99a12f9adc4f6e99d665}{WMP}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{kplus1jminus1}}]\ *\ \mbox{\hyperlink{common_8cpp_a9fe853f65a0f16e66d7a28c7b9fa551c}{bw\_int}}(\mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_a3406bfe1dbd73a8cd9fede03816a1fa2}{multi\_helix\_penalty}}\ +\ \mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_ab6141294a0aac68e8a99e4b29cbdca86}{multi\_offset}}\ +\ \mbox{\hyperlink{common_8h_ab8cd17eff60c63faedab23965fdf886d}{AU\_penalty}}\ (\mbox{\hyperlink{class_v_m__final_a25c1aaa232ddde4a1e5a4b838ac7a4f7}{sequence}}[i],\ \mbox{\hyperlink{class_v_m__final_a25c1aaa232ddde4a1e5a4b838ac7a4f7}{sequence}}[j]));}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00083}00083\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Luke\ adding\ new\ case\ 3\ WMP\ exit\ early\ by\ one\ iter\ wrt\ cases\ 1\ \&\ 2}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00084}00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}!=j-\/1)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{kjminus1}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}]\ +\ j-\/1-\/\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_vm}}\ +=\ \mbox{\hyperlink{class_v_m__final_a1582016485ac99a12f9adc4f6e99d665}{WMP}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{kjminus1}}]\ *\ \mbox{\hyperlink{common_8cpp_a9fe853f65a0f16e66d7a28c7b9fa551c}{bw\_int}}(((\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}-\/i-\/1)*\mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_a6f66c30c31c361d522016caf261b29aa}{multi\_free\_base\_penalty}})\ +\ \mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_a3406bfe1dbd73a8cd9fede03816a1fa2}{multi\_helix\_penalty}}\ +\ \mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_ab6141294a0aac68e8a99e4b29cbdca86}{multi\_offset}}\ +\ \mbox{\hyperlink{common_8h_ab8cd17eff60c63faedab23965fdf886d}{AU\_penalty}}\ (\mbox{\hyperlink{class_v_m__final_a25c1aaa232ddde4a1e5a4b838ac7a4f7}{sequence}}[i],\ \mbox{\hyperlink{class_v_m__final_a25c1aaa232ddde4a1e5a4b838ac7a4f7}{sequence}}[j]));}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00087}00087\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00088}00088\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00089}00089\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00091}00091\ \ \ \ \ \textcolor{comment}{//\ previous\ case\ 3}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00092}00092\ \ \ \ \ \textcolor{comment}{//min\ +=\ misc.multi\_helix\_penalty\ +\ misc.multi\_offset\ +}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00093}00093\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ AU\_penalty\ (sequence[i],\ sequence[j]);}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00094}00094\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00095}00095\ \ \ \ \ \textcolor{comment}{//int\ wmb\_energy\ =\ this-\/>wmb-\/>get\_energy(i,j)\ +\ a\_penalty\ +\ PSM\_penalty;}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00096}00096\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i]+j-\/i;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00097}00097\ \ \ \ \ \textcolor{comment}{//if(debug)\{}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00098}00098\ \ \ \ \ \textcolor{comment}{//printf("{}VM[\%d,\%d]\ =\ \%Lf\ \(\backslash\)n"{},i,j,d2\_energy\_vm);}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00099}00099\ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00100}00100\ \ \ \ \ \mbox{\hyperlink{class_v_m__final_af61903e978064ce7a10d483598e339f5}{VM}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}]\ =\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_vm}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00101}00101\ \ \ \ \ \textcolor{comment}{//if\ (VM[ij]\ >\ 0.0)\{}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00102}00102\ \ \ \ \ \textcolor{comment}{//\ \ \ \ printf("{}VM[\%d,\%d]\ =\ \%Lf\ \(\backslash\)n"{},i,j,VM[ij]);}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00103}00103\ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00104}00104\ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00106}00106\ \textcolor{comment}{//Luke\ Aug\ 2023\ base\ case\ 0\ for\ partition\ function}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00107}\mbox{\hyperlink{class_v_m__final_a45c07d4f6190636f933bd890bd460bb9}{00107}}\ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{class_v_m__final_a45c07d4f6190636f933bd890bd460bb9}{VM\_final::get\_energy}}(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00108}00108\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i]+j-\/i;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00109}00109\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >=\ j)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00110}00110\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00111}00111\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00112}00112\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_v_m__final_ab44b4b037c46d438421fdf68f7f06973}{wmb}}-\/>\mbox{\hyperlink{classpseudo__loop_ac1df80ab6645a8851e9fb3e6909737a5}{is\_weakly\_closed}}(i,j)\ ==\ 1\ ||\ \mbox{\hyperlink{class_v_m__final_ab44b4b037c46d438421fdf68f7f06973}{wmb}}-\/>\mbox{\hyperlink{classpseudo__loop_a1694b876c1b29584cf3cb9ba3ee804c4}{is\_empty\_region}}(i,j)\ ==\ 1)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00113}00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_v_m__final_af61903e978064ce7a10d483598e339f5}{VM}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}];}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00114}00114\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00115}00115\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00116}00116\ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00117}00117\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00118}00118\ \textcolor{comment}{/********************************************/}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00125}\mbox{\hyperlink{class_v_m__final_a9c3e90075d7373cd51e15843d3e268a2}{00125}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_v_m__final_a9c3e90075d7373cd51e15843d3e268a2}{VM\_final::WM\_compute\_energy}}(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00126}00126\ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{s\_wm}}\ =\ \mbox{\hyperlink{class_v_m__final_a2e00493c1001218244e6414aaa2c7c99}{s\_vm}}-\/>\mbox{\hyperlink{classs__multi__loop_a0dfef210c63059c71da81320028ca2db}{get\_energy\_WM}}(i,j);}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00127}00127\ \ \ \ \ \textcolor{comment}{//PARAMTYPE\ tmp;}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00128}00128\ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wm}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00131}00131\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}=i;\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}\ <\ j;\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}++)}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00132}00132\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00133}00133\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ wmb\ energy\ for\ split}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00134}00134\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Hosna:\ July\ 5th,\ 2007}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00135}00135\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ add\ a\ b\_penalty\ to\ this\ case\ to\ match\ the\ previous\ cases}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00136}00136\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{wmb\_energy}}\ =\ \mbox{\hyperlink{class_v_m__final_ab44b4b037c46d438421fdf68f7f06973}{wmb}}-\/>\mbox{\hyperlink{classpseudo__loop_a6aff3e370e0de9dbfc403dedb202cac1}{get\_energy}}(\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}},j)*\mbox{\hyperlink{h__externs_8h_a69c32b92e1455337ddf99e0ff5f0efb1}{PSM\_penalty}}*\mbox{\hyperlink{h__externs_8h_a03765fe2c0e7ecf11b22dd2865017a63}{b\_penalty}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00137}00137\ \ \ \ \ \ \ \ \ \textcolor{comment}{//unpaired}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00138}00138\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{unpaired\_energy}}\ =\ \ \mbox{\hyperlink{common_8cpp_a9fe853f65a0f16e66d7a28c7b9fa551c}{bw\_int}}(\mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_a6f66c30c31c361d522016caf261b29aa}{multi\_free\_base\_penalty}})\ *(\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}-\/i);}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00139}00139\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ new\ case\ 2\ (leftmost\ branch\ pseudoknotted)}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00140}00140\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wm}}\ +=\ (\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{unpaired\_energy}}\ *\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{wmb\_energy}});}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00141}00141\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ new\ case\ 4\ checking\ both\ WM\ for\ now\ (intermediate\ branch\ pseudoknotted)}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00142}00142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}\ >\ i\ \&\&\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}\ <\ (j-\/1))\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//4a\ simfold\ wm}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wm}}\ +=\ \mbox{\hyperlink{class_v_m__final_a2e00493c1001218244e6414aaa2c7c99}{s\_vm}}-\/>\mbox{\hyperlink{classs__multi__loop_a0dfef210c63059c71da81320028ca2db}{get\_energy\_WM}}(i,\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{k}}-\/1)\ *\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{wmb\_energy}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//4b\ hfold\ wm}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//tmp\ =\ get\_energy\_WM(i,\ k-\/1)\ +\ wmb\_energy;}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00147}00147\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00148}00148\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00149}00149\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i]+j-\/i;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00150}00150\ \ \ \ \ \textcolor{comment}{//pk\ free\ for\ now}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00151}00151\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{s\_wm}}\ ==\ \mbox{\hyperlink{constants_8h_a12c2040f25d8e3a7b9e1c2024c618cb6}{INF}})\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00152}00152\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{s\_wm}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00153}00153\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00154}00154\ \ \ \ \ this-\/>\mbox{\hyperlink{class_v_m__final_a0c8581d26850e7e1d79134d44bfa19a4}{WM}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}]\ =\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{s\_wm}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00155}00155\ \ \ \ \ \textcolor{comment}{//printf("{}hfold's\ WM\ min\ =\ \%Lf\ \(\backslash\)n"{},s\_wm);}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00156}00156\ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00158}00158\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00159}00159\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00160}\mbox{\hyperlink{class_v_m__final_ab524aa6626796d1c589d67bfa4b20254}{00160}}\ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{class_v_m__final_ab524aa6626796d1c589d67bfa4b20254}{VM\_final::get\_energy\_WM}}(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00161}00161\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >=\ j\ ||\ \mbox{\hyperlink{class_v_m__final_ab44b4b037c46d438421fdf68f7f06973}{wmb}}-\/>\mbox{\hyperlink{classpseudo__loop_ac1df80ab6645a8851e9fb3e6909737a5}{is\_weakly\_closed}}(i,j)\ !=\ 1\ )\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00162}00162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00163}00163\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00164}00164\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i]+j-\/i;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00165}00165\ \textcolor{comment}{//\ \ printf("{}hfold's\ WM(\%d,\%d)\ =\ \%d\ \(\backslash\)n"{},\ i,j,WM[ij]);}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00166}00166\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{class_v_m__final_a0c8581d26850e7e1d79134d44bfa19a4}{WM}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}];}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00167}00167\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00168}00168\ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00169}00169\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00170}00170\ \textcolor{comment}{/********************************************/}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00174}\mbox{\hyperlink{class_v_m__final_a820f63cb34cbeec468513c98826a8795}{00174}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_v_m__final_a820f63cb34cbeec468513c98826a8795}{VM\_final::WM1\_compute\_energy}}(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00175}00175\ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{v\_energy}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00176}00176\ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wm1}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00177}00177\ \ \ \ \ \textcolor{comment}{//case\ 2\ j\ unpaired}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00178}00178\ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{unpaired\_energy}}\ =\ \ \mbox{\hyperlink{common_8cpp_a9fe853f65a0f16e66d7a28c7b9fa551c}{bw\_int}}(\mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_a6f66c30c31c361d522016caf261b29aa}{multi\_free\_base\_penalty}});}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00179}00179\ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{wm1substruc\_en}}\ =\ \mbox{\hyperlink{class_v_m__final_a744b0094fb92df39077064611782e0cf}{get\_energy\_WM1}}(i,\ j-\/1);}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00180}00180\ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wm1}}\ +=\ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{wm1substruc\_en}}\ *\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{unpaired\_energy}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00181}00181\ \ \ \ \ \textcolor{comment}{//printf("{}CParty\ Z\_WM1\ case\ 2\ =\ \%Lf\ \(\backslash\)n"{},get\_energy\_WM1(i,\ j-\/1)\ *\ unpaired\_energy);}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00182}00182\ \ \ \ \ \textcolor{comment}{//case\ 1}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00183}00183\ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{v\_energy}}\ =\ \mbox{\hyperlink{class_v_m__final_a194e9caa8420fa196e18179389238853}{v}}-\/>\mbox{\hyperlink{class_v__final_ae23f580a926dc89582ba33921e2fe1b3}{get\_energy}}(i,j)\ *\ \mbox{\hyperlink{common_8cpp_a9fe853f65a0f16e66d7a28c7b9fa551c}{bw\_int}}(}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00184}00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{common_8h_ab8cd17eff60c63faedab23965fdf886d}{AU\_penalty}}\ (\mbox{\hyperlink{class_v_m__final_a25c1aaa232ddde4a1e5a4b838ac7a4f7}{sequence}}[i],\ \mbox{\hyperlink{class_v_m__final_a25c1aaa232ddde4a1e5a4b838ac7a4f7}{sequence}}[j])\ +}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00185}00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_a3406bfe1dbd73a8cd9fede03816a1fa2}{multi\_helix\_penalty}});}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00186}00186\ \ \ \ \ \textcolor{comment}{//printf("{}CParty\ Z\_WM1\ case\ 1\ =\ \%Lf\ \(\backslash\)n"{},v\_energy);}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00187}00187\ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wm1}}\ +=\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{v\_energy}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00188}00188\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i]+j-\/i;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00189}00189\ \ \ \ \ this-\/>\mbox{\hyperlink{class_v_m__final_a5d890ab36a54d7ca2f600abb94b42f84}{WM1}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}]\ =\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wm1}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00190}00190\ \ \ \ \ \textcolor{comment}{//printf("{}CParty\ Z\_WM1\ =\ \%Lf\ \(\backslash\)n"{},d2\_energy\_wm1);}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00191}00191\ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00192}00192\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00193}\mbox{\hyperlink{class_v_m__final_a744b0094fb92df39077064611782e0cf}{00193}}\ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{class_v_m__final_a744b0094fb92df39077064611782e0cf}{VM\_final::get\_energy\_WM1}}(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00194}00194\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >=\ j\ ||\ \mbox{\hyperlink{class_v_m__final_ab44b4b037c46d438421fdf68f7f06973}{wmb}}-\/>\mbox{\hyperlink{classpseudo__loop_ac1df80ab6645a8851e9fb3e6909737a5}{is\_weakly\_closed}}(i,j)\ !=\ 1\ )\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00195}00195\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00196}00196\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00197}00197\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i]+j-\/i;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00198}00198\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{class_v_m__final_a5d890ab36a54d7ca2f600abb94b42f84}{WM1}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}];}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00199}00199\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00200}00200\ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00201}00201\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00202}00202\ \textcolor{comment}{/********************************************/}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00206}\mbox{\hyperlink{class_v_m__final_a3b13a507e6182e6e10d1027aef3b437f}{00206}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{class_v_m__final_a3b13a507e6182e6e10d1027aef3b437f}{VM\_final::WMP\_compute\_energy}}(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00207}00207\ \ \ \ \ \textcolor{comment}{//PARAMTYPE\ tmp\ =\ INF;}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00208}00208\ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wmp}}\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00209}00209\ \ \ \ \ \textcolor{comment}{//case\ 2\ j\ unpaired}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00210}00210\ \ \ \ \ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{unpaired\_energy}}\ =\ \ \mbox{\hyperlink{externs_8h_a3739a0e5c2b0885a444527e39624a641}{misc}}.\mbox{\hyperlink{structmiscinfo_a6f66c30c31c361d522016caf261b29aa}{multi\_free\_base\_penalty}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00211}00211\ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wmp}}\ +=\ \mbox{\hyperlink{class_v_m__final_a7c07fd080ac63b1f714f4fce6ddd7408}{get\_energy\_WMP}}(i,\ j-\/1)\ *\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{unpaired\_energy}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00212}00212\ \ \ \ \ \textcolor{comment}{//case\ 1}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00213}00213\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{wmb\_energy}}\ =\ this-\/>\mbox{\hyperlink{class_v_m__final_ab44b4b037c46d438421fdf68f7f06973}{wmb}}-\/>\mbox{\hyperlink{classpseudo__loop_a6aff3e370e0de9dbfc403dedb202cac1}{get\_energy}}(i,j)\ *\mbox{\hyperlink{h__externs_8h_a69c32b92e1455337ddf99e0ff5f0efb1}{PSM\_penalty}}*\mbox{\hyperlink{h__externs_8h_a03765fe2c0e7ecf11b22dd2865017a63}{b\_penalty}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00214}00214\ \ \ \ \ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wmp}}\ +=\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{wmb\_energy}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00215}00215\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00216}00216\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i]+j-\/i;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00217}00217\ \ \ \ \ this-\/>\mbox{\hyperlink{class_v_m__final_a1582016485ac99a12f9adc4f6e99d665}{WMP}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}]\ =\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{d2\_energy\_wmp}};}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00218}00218\ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00219}00219\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00220}\mbox{\hyperlink{class_v_m__final_a7c07fd080ac63b1f714f4fce6ddd7408}{00220}}\ \mbox{\hyperlink{constants_8h_adf823d40ac379702030cb342e84d5f2e}{pf\_t}}\ \mbox{\hyperlink{class_v_m__final_a7c07fd080ac63b1f714f4fce6ddd7408}{VM\_final::get\_energy\_WMP}}(\textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j)\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00221}00221\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >=\ j\ ||\ \mbox{\hyperlink{class_v_m__final_ab44b4b037c46d438421fdf68f7f06973}{wmb}}-\/>\mbox{\hyperlink{classpseudo__loop_ac1df80ab6645a8851e9fb3e6909737a5}{is\_weakly\_closed}}(i,j)\ !=\ 1\ )\{}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00222}00222\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00223}00223\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00224}00224\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}\ =\ \mbox{\hyperlink{class_v_m__final_a5a50472fca30b2b349b11e890efd0c93}{index}}[i]+j-\/i;}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00225}00225\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>\mbox{\hyperlink{class_v_m__final_a1582016485ac99a12f9adc4f6e99d665}{WMP}}[\mbox{\hyperlink{externs_8h_aafffe6ecab26711851f2a71b500f0509}{ij}}];}
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00226}00226\ }
\DoxyCodeLine{\Hypertarget{_v_m__final_8cpp_source_l00227}00227\ \}}

\end{DoxyCode}
